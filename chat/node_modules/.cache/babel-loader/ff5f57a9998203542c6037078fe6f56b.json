{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nazar\\\\Desktop\\\\\\u043F\\u043E\\u0440\\u0442\\u0444\\u043E\\u043B\\u0456\\u043E \\u043F\\u0440\\u043E\\u0441\\u0442\\u0438\\u0439 \\u0447\\u0430\\u0442\\\\chat\\\\src\\\\Dashbord\\\\Dashbord.js\";\nimport React from 'react';\nimport NewChatComponent from '../NewChat/newChat';\nimport ChatListComponent from '../ChatList/ChatList';\nimport ChatViewComponent from '../';\nimport ChatTextBoxComponent from '../ChatTextBox/chatTextBox';\nimport styles from './Style';\nimport { Button, withStyles } from '@material-ui/core';\n\nconst firebase = require(\"firebase\");\n\nclass DashboardComponent extends React.Component {\n  constructor() {\n    super();\n\n    this.signOut = () => firebase.auth().signOut();\n\n    this.submitMessage = msg => {\n      const docKey = this.buildDocKey(this.state.chats[this.state.selectedChat].users.filter(_usr => _usr !== this.state.email)[0]);\n      firebase.firestore().collection('chats').doc(docKey).update({\n        messages: firebase.firestore.FieldValue.arrayUnion({\n          sender: this.state.email,\n          message: msg,\n          timestamp: Date.now()\n        }),\n        receiverHasRead: false\n      });\n    };\n\n    this.buildDocKey = friend => [this.state.email, friend].sort().join(':');\n\n    this.newChatBtnClicked = () => this.setState({\n      newChatFormVisible: true,\n      selectedChat: null\n    });\n\n    this.newChatSubmit = async chatObj => {\n      const docKey = this.buildDocKey(chatObj.sendTo);\n      await firebase.firestore().collection('chats').doc(docKey).set({\n        messages: [{\n          message: chatObj.message,\n          sender: this.state.email\n        }],\n        users: [this.state.email, chatObj.sendTo],\n        receiverHasRead: false\n      });\n      this.setState({\n        newChatFormVisible: false\n      });\n      this.selectChat(this.state.chats.length - 1);\n    };\n\n    this.selectChat = async chatIndex => {\n      await this.setState({\n        selectedChat: chatIndex,\n        newChatFormVisible: false\n      });\n      this.messageRead();\n    };\n\n    this.goToChat = async (docKey, msg) => {\n      const usersInChat = docKey.split(':');\n      const chat = this.state.chats.find(_chat => usersInChat.every(_user => _chat.users.includes(_user)));\n      this.setState({\n        newChatFormVisible: false\n      });\n      await this.selectChat(this.state.chats.indexOf(chat));\n      this.submitMessage(msg);\n    };\n\n    this.messageRead = () => {\n      const chatIndex = this.state.selectedChat;\n      const docKey = this.buildDocKey(this.state.chats[chatIndex].users.filter(_usr => _usr !== this.state.email)[0]);\n\n      if (this.clickedMessageWhereNotSender(chatIndex)) {\n        firebase.firestore().collection('chats').doc(docKey).update({\n          receiverHasRead: true\n        });\n      } else {\n        console.log('Clicked message where the user was the sender');\n      }\n    };\n\n    this.clickedMessageWhereNotSender = chatIndex => this.state.chats[chatIndex].messages[this.state.chats[chatIndex].messages.length - 1].sender !== this.state.email;\n\n    this.componentWillMount = () => {\n      firebase.auth().onAuthStateChanged(async _usr => {\n        if (!_usr) this.props.history.push('/login');else {\n          await firebase.firestore().collection('chats').where('users', 'array-contains', _usr.email).onSnapshot(async res => {\n            const chats = res.docs.map(_doc => _doc.data());\n            await this.setState({\n              email: _usr.email,\n              chats: chats,\n              friends: []\n            });\n          });\n        }\n      });\n    };\n\n    this.state = {\n      selectedChat: null,\n      newChatFormVisible: false,\n      email: null,\n      friends: [],\n      chats: []\n    };\n  }\n\n  render() {\n    const {\n      classes\n    } = this.props;\n\n    if (this.state.email) {\n      return React.createElement(\"div\", {\n        className: \"dashboard-container\",\n        id: \"dashboard-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 31\n        },\n        __self: this\n      }, React.createElement(ChatListComponent, {\n        history: this.props.history,\n        userEmail: this.state.email,\n        selectChatFn: this.selectChat,\n        chats: this.state.chats,\n        selectedChatIndex: this.state.selectedChat,\n        newChatBtnFn: this.newChatBtnClicked,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 32\n        },\n        __self: this\n      }), this.state.newChatFormVisible ? null : React.createElement(ChatViewComponent, {\n        user: this.state.email,\n        chat: this.state.chats[this.state.selectedChat],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }), this.state.selectedChat !== null && !this.state.newChatFormVisible ? React.createElement(ChatTextBoxComponent, {\n        userClickedInputFn: this.messageRead,\n        submitMessageFn: this.submitMessage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46\n        },\n        __self: this\n      }) : null, this.state.newChatFormVisible ? React.createElement(NewChatComponent, {\n        goToChatFn: this.goToChat,\n        newChatSubmitFn: this.newChatSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49\n        },\n        __self: this\n      }) : null, React.createElement(Button, {\n        onClick: this.signOut,\n        className: classes.signOutBtn,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }, \"Sign Out\"));\n    } else {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      }, \"LOADING....\");\n    }\n  }\n\n}\n\nexport default withStyles(styles)(DashboardComponent);","map":{"version":3,"sources":["C:/Users/nazar/Desktop/портфоліо простий чат/chat/src/Dashbord/Dashbord.js"],"names":["React","NewChatComponent","ChatListComponent","ChatViewComponent","ChatTextBoxComponent","styles","Button","withStyles","firebase","require","DashboardComponent","Component","constructor","signOut","auth","submitMessage","msg","docKey","buildDocKey","state","chats","selectedChat","users","filter","_usr","email","firestore","collection","doc","update","messages","FieldValue","arrayUnion","sender","message","timestamp","Date","now","receiverHasRead","friend","sort","join","newChatBtnClicked","setState","newChatFormVisible","newChatSubmit","chatObj","sendTo","set","selectChat","length","chatIndex","messageRead","goToChat","usersInChat","split","chat","find","_chat","every","_user","includes","indexOf","clickedMessageWhereNotSender","console","log","componentWillMount","onAuthStateChanged","props","history","push","where","onSnapshot","res","docs","map","_doc","data","friends","render","classes","signOutBtn"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport NewChatComponent from '../NewChat/newChat';\r\nimport ChatListComponent from '../ChatList/ChatList';\r\nimport ChatViewComponent from '../';\r\nimport ChatTextBoxComponent from '../ChatTextBox/chatTextBox';\r\nimport styles from './Style';\r\nimport { Button, withStyles } from '@material-ui/core';\r\nconst firebase = require(\"firebase\");\r\n\r\n\r\n\r\nclass DashboardComponent extends React.Component {\r\n\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      selectedChat: null,\r\n      newChatFormVisible: false,\r\n      email: null,\r\n      friends: [],\r\n      chats: []\r\n    };\r\n  }\r\n\r\n  render() {\r\n\r\n    const { classes } = this.props;\r\n\r\n    if(this.state.email) {\r\n      return(\r\n        <div className='dashboard-container' id='dashboard-container'>\r\n          <ChatListComponent history={this.props.history} \r\n            userEmail={this.state.email} \r\n            selectChatFn={this.selectChat} \r\n            chats={this.state.chats} \r\n            selectedChatIndex={this.state.selectedChat}\r\n            newChatBtnFn={this.newChatBtnClicked}>\r\n          </ChatListComponent>\r\n          {\r\n            this.state.newChatFormVisible ? null : <ChatViewComponent \r\n              user={this.state.email} \r\n              chat={this.state.chats[this.state.selectedChat]}>\r\n            </ChatViewComponent>\r\n          }\r\n          { \r\n            this.state.selectedChat !== null && !this.state.newChatFormVisible ? <ChatTextBoxComponent userClickedInputFn={this.messageRead} submitMessageFn={this.submitMessage}></ChatTextBoxComponent> : null \r\n          }\r\n          {\r\n            this.state.newChatFormVisible ? <NewChatComponent goToChatFn={this.goToChat} newChatSubmitFn={this.newChatSubmit}></NewChatComponent> : null\r\n          }\r\n          <Button onClick={this.signOut} className={classes.signOutBtn}>Sign Out</Button>\r\n        </div>\r\n      );\r\n    } else {\r\n      return(<div>LOADING....</div>);\r\n    }\r\n  }\r\n\r\n  signOut = () => firebase.auth().signOut();\r\n\r\n  submitMessage = (msg) => {\r\n    const docKey = this.buildDocKey(this.state.chats[this.state.selectedChat]\r\n      .users\r\n      .filter(_usr => _usr !== this.state.email)[0])\r\n    firebase\r\n      .firestore()\r\n      .collection('chats')\r\n      .doc(docKey)\r\n      .update({\r\n        messages: firebase.firestore.FieldValue.arrayUnion({\r\n          sender: this.state.email,\r\n          message: msg,\r\n          timestamp: Date.now()\r\n        }),\r\n        receiverHasRead: false\r\n      });\r\n  }\r\n\r\n  // Always in alphabetical order:\r\n  // 'user1:user2'\r\n  buildDocKey = (friend) => [this.state.email, friend].sort().join(':');\r\n\r\n  newChatBtnClicked = () => this.setState({ newChatFormVisible: true, selectedChat: null });\r\n\r\n  newChatSubmit = async (chatObj) => {\r\n    const docKey = this.buildDocKey(chatObj.sendTo);\r\n    await \r\n      firebase\r\n        .firestore()\r\n        .collection('chats')\r\n        .doc(docKey)\r\n        .set({\r\n          messages: [{\r\n            message: chatObj.message,\r\n            sender: this.state.email\r\n          }],\r\n          users: [this.state.email, chatObj.sendTo],\r\n          receiverHasRead: false\r\n        })\r\n    this.setState({ newChatFormVisible: false });\r\n    this.selectChat(this.state.chats.length - 1);\r\n  }\r\n\r\n  selectChat = async (chatIndex) => {\r\n    await this.setState({ selectedChat: chatIndex, newChatFormVisible: false });\r\n    this.messageRead();\r\n  }\r\n\r\n  goToChat = async (docKey, msg) => {\r\n    const usersInChat = docKey.split(':');\r\n    const chat = this.state.chats.find(_chat => usersInChat.every(_user => _chat.users.includes(_user)));\r\n    this.setState({ newChatFormVisible: false });\r\n    await this.selectChat(this.state.chats.indexOf(chat));\r\n    this.submitMessage(msg);\r\n  }\r\n\r\n  // Chat index could be different than the one we are currently on in the case\r\n  // that we are calling this function from within a loop such as the chatList.\r\n  // So we will set a default value and can overwrite it when necessary.\r\n  messageRead = () => {\r\n    const chatIndex = this.state.selectedChat;\r\n    const docKey = this.buildDocKey(this.state.chats[chatIndex].users.filter(_usr => _usr !== this.state.email)[0]);\r\n    if(this.clickedMessageWhereNotSender(chatIndex)) {\r\n      firebase\r\n        .firestore()\r\n        .collection('chats')\r\n        .doc(docKey)\r\n        .update({ receiverHasRead: true });\r\n    } else {\r\n      console.log('Clicked message where the user was the sender');\r\n    }\r\n  }\r\n\r\n  clickedMessageWhereNotSender = (chatIndex) => this.state.chats[chatIndex].messages[this.state.chats[chatIndex].messages.length - 1].sender !== this.state.email;\r\n\r\n  componentWillMount = () => {\r\n      firebase.auth().onAuthStateChanged(async _usr => {\r\n        if(!_usr)\r\n          this.props.history.push('/login');\r\n        else {\r\n          await firebase\r\n            .firestore()\r\n            .collection('chats')\r\n            .where('users', 'array-contains', _usr.email)\r\n            .onSnapshot(async res => {\r\n              const chats = res.docs.map(_doc => _doc.data());\r\n              await this.setState({\r\n                email: _usr.email,\r\n                chats: chats,\r\n                friends: []\r\n              });\r\n            })\r\n        }\r\n    });\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(DashboardComponent);"]},"metadata":{},"sourceType":"module"}